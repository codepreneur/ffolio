xml2json={parser:function(a,b,c){b||(b=""),a=a.replace(/\s*\/>/g,"/>"),a=a.replace(/<\?[^>]*>/g,"").replace(/<\![^>]*>/g,""),b.sort||(b=b.split(","));var d=this.no_fast_endings(a);d=this.attris_to_tags(d),d=escape(d),d=d.split("%3C").join("<").split("%3E").join(">").split("%3D").join("=").split("%22").join('"');for(var e=0;e<b.length;e++)d=d.replace(new RegExp("<"+b[e]+">","g"),"*$**"+b[e]+"**$*"),d=d.replace(new RegExp("</"+b[e]+">","g"),"*$***"+b[e]+"**$*");d="<JSONTAGWRAPPER>"+d+"</JSONTAGWRAPPER>",this.xmlobject={};var f=this.xml_to_object(d).jsontagwrapper;return c&&(f=this.show_json_structure(f,c)),f},xml_to_object:function(xmlcode){var x=xmlcode.replace(/<\//g,"ยง");x=x.split("<");for(var y=[],level=0,opentags=[],i=1;i<x.length;i++){var tagname=x[i].split(">")[0];for(opentags.push(tagname),level++,y.push(level+"<"+x[i].split("ยง")[0]);x[i].indexOf("ยง"+opentags[opentags.length-1]+">")>=0;)level--,opentags.pop()}for(var oldniva=-1,objname="this.xmlobject",i=0;i<y.length;i++){var preeval="",niva=y[i].split("<")[0],tagnamn=y[i].split("<")[1].split(">")[0];tagnamn=tagnamn.toLowerCase();var rest=y[i].split(">")[1];if(oldniva>=niva)for(var tabort=oldniva-niva+1,j=0;tabort>j;j++)objname=objname.substring(0,objname.lastIndexOf("."));objname+="."+tagnamn;var pobject=objname.substring(0,objname.lastIndexOf("."));"object"!=eval("typeof "+pobject)&&(preeval+=pobject+"={value:"+pobject+"};\n");var objlast=objname.substring(objname.lastIndexOf(".")+1),already=!1;for(k in eval(pobject))k==objlast&&(already=!0);for(var onlywhites=!0,s=0;s<rest.length;s+=3)"%"!=rest.charAt(s)&&(onlywhites=!1);""==rest||onlywhites?rest="{}":rest/1!=rest&&(rest="'"+rest.replace(/\'/g,"\\'")+"'",rest=rest.replace(/\*\$\*\*\*/g,"</"),rest=rest.replace(/\*\$\*\*/g,"<"),rest=rest.replace(/\*\*\$\*/g,">")),"'"==rest.charAt(0)&&(rest="unescape("+rest+")"),already&&!eval(objname+".sort")&&(preeval+=objname+"=["+objname+"];\n");var before="=";after="",already&&(before=".push(",after=")");var toeval=preeval+objname+before+rest+after;eval(toeval),eval(objname+".sort")&&(objname+="["+eval(objname+".length-1")+"]"),oldniva=niva}return this.xmlobject},show_json_structure:function(a,b,c){var d="";d+=a.sort?"[\n":"{\n";for(var e in a)if(a.sort||(d+=e+":"),"object"==typeof a[e])d+=this.show_json_structure(a[e],!1,1);else if("function"==typeof a[e]){var f=a[e]+"";d+=f}else d+="string"!=typeof a[e]?a[e]+",\n":"'"+a[e].replace(/\'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")+"',\n";if(d+=a.sort?"],\n":"},\n",!c){d=d.substring(0,d.lastIndexOf(",")),d=d.replace(new RegExp(",\n}","g"),"\n}"),d=d.replace(new RegExp(",\n]","g"),"\n]");var g=d.split("\n");d="";for(var h=0,e=0;e<g.length;e++){(g[e].indexOf("}")>=0||g[e].indexOf("]")>=0)&&h--,tabs="";for(var i=0;h>i;i++)tabs+="	";d+=tabs+g[e]+"\n",(g[e].indexOf("{")>=0||g[e].indexOf("[")>=0)&&h++}"html"==b&&(d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d=d.replace(/\n/g,"<BR>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")),"compact"==b&&(d=d.replace(/\n/g,"").replace(/\t/g,""))}return d},no_fast_endings:function(a){a=a.split("/>");for(var b=1;b<a.length;b++){var c=a[b-1].substring(a[b-1].lastIndexOf("<")+1).split(" ")[0];a[b]="></"+c+">"+a[b]}return a=a.join("")},attris_to_tags:function(a){var b=" =\"'".split("");a=a.split(">");for(var c=0;c<a.length;c++){for(var d=a[c].split("<"),e=0;4>e;e++)d[0]=d[0].replace(new RegExp(b[e],"g"),"_jsonconvtemp"+e+"_");if(d[1]){d[1]=d[1].replace(/'/g,'"'),d[1]=d[1].split('"');for(var f=1;f<d[1].length;f+=2)for(var e=0;4>e;e++)d[1][f]=d[1][f].replace(new RegExp(b[e],"g"),"_jsonconvtemp"+e+"_");d[1]=d[1].join('"')}a[c]=d.join("<")}a=a.join(">"),a=a.replace(/ ([^=]*)=([^ |>]*)/g,"><$1>$2</$1"),a=a.replace(/>"/g,">").replace(/"</g,"<");for(var e=0;4>e;e++)a=a.replace(new RegExp("_jsonconvtemp"+e+"_","g"),b[e]);return a}},Array.prototype.push||(Array.prototype.push=function(a){return this[this.length]=a,!0}),Array.prototype.pop||(Array.prototype.pop=function(){var a=this[this.length-1];return this.length--,a}),angular.module("ffolioApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angular-medium-editor","ngS3upload","angularFileUpload"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/editor",{templateUrl:"views/editor.html",controller:"EditorCtrl"}).when("/landing",{templateUrl:"views/landing.html",controller:"LandingCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/organisation_directory",{templateUrl:"views/organisation_directory.html",controller:"DirectoryCtrl"}).when("/portfolio",{templateUrl:"views/portfolio.html",controller:"PortfolioCtrl"}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("ffolioApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ffolioApp").controller("EditorCtrl",["$scope",function(){}]),angular.module("ffolioApp").controller("LandingCtrl",["$scope",function(){}]),angular.module("ffolioApp").controller("LoginCtrl",["$scope",function(){}]),angular.module("ffolioApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ffolioApp").controller("DirectoryCtrl",["$scope",function(){}]),angular.module("ffolioApp").controller("PortfolioCtrl",["$scope","$http","$location","$upload","$rootScope",function(a,b,c,d){a.pendingImages=[],a.remove=function(c){b.delete("/api/images/"+c).success(function(b){a.images=_.filter(a.images,function(a){return b.id!==a.id})})},b.get("/api/images").success(function(b){a.images=b}),a.imageUploads=[],a.abort=function(b){a.upload[b].abort(),a.upload[b]=null},a.onFileSelect=function(c){a.files=c,a.upload=[];for(var e=0;e<c.length;e++){var f=c[e];f.progress=parseInt(0),function(c,e){b.get("/api/s3?mimeType="+c.type).success(function(f){var g=f,h="s3UploadExample/"+Math.round(1e4*Math.random())+"$$"+c.name;b.post("/api/images",{url:"https://s3.amazonaws.com/ffolio/"+h.replace("$$","%24")}).success(function(b){a.pendingImages.push(b)}),a.upload[e]=d.upload({url:"https://ffolio.s3.amazonaws.com/",method:"POST",data:{key:h,acl:"public-read","Content-Type":c.type,AWSAccessKeyId:g.key,Policy:g.policy,Signature:g.signature},file:c}).then(function(b){if(console.log(b),c.progress=parseInt(100),201===b.status){var d,e=xml2json.parser(b.data);d={location:e.postresponse.location,bucket:e.postresponse.bucket,key:e.postresponse.key,etag:e.postresponse.etag},a.imageUploads.push(d)}else console.log("Upload Failed"),a.images.push(a.pendingImages.pop())},null,function(a){c.progress=parseInt(100*a.loaded/a.total)})})}(f,e)}}}]),angular.module("ffolioApp").controller("ProfileCtrl",["$scope",function(){}]);